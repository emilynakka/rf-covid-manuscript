---
title             : "Regulatory Focus Pride and COVID-19 (Analysis Code)"
author            : "[Author names redacted for blind peer review]"
output:
  pdf_document:
    toc: true
    toc_depth: 2
header-includes:
   - \usepackage[utf8]{inputenc}
   - \usepackage{float}
   - \floatplacement{figure}{H}
   - \DeclareUnicodeCharacter{2588}{-}
   - \usepackage{setspace}
   - \usepackage{makecell}
   - \raggedbottom
---

# Setup and Data Cleaning

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
knitr::opts_knit$set(root.dir = normalizePath('../'))
options(scipen = 999)
```

## Load Libraries, Themes, and Functions

```{r libs}
# Load libraries
library(knitr) # Required for knitting
library(readxl) # Required to load .xlsx file
library(plyr) # Required for summarySE() function
library(tidyverse) # Required for data cleaning
library(broman) # Required for myround() function that doesn't truncate digits
library(ggsignif) # Required for plots with significance stars
library(grid) # Required to print plots side by side
library(gridExtra) # Required to print plots side by side

# Load themes
mythemeweb = theme_classic(base_size = 13) +
    theme(legend.position = 'none',
          panel.grid.minor = element_blank(),
          panel.grid.major = element_blank(),
          plot.background = element_rect(fill = "transparent", color = NA),
          panel.background = element_rect(fill = "transparent", color = NA),
          strip.text.x = element_blank(),
          panel.spacing = unit(0.1, "cm"),
          panel.border = element_rect(color="black", fill=NA),
          text = element_text(family="Helvetica", size=13),
          axis.text.x = element_text(size=11, margin=unit(c(5,0,2,0), "mm")),
          axis.text.y = element_text(size=11, margin=unit(c(0,5,0,0), "mm")),
          axis.ticks = element_line(size = .5),
          axis.ticks.length=unit(-2, "mm"))
theme_set(mythemeweb)

# Define functions
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- plyr::ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- plyr::rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
```

## Load and Clean Data

```{r clean}
# IMPORT DATA
rf_2019 <- read.csv(file="data/RFQ_Dec2019.csv", header = TRUE)
rf_2020 <- read_excel("data/RAW DATA BeSci Analytic Engine without zipcode.xlsx", col_names = TRUE)

## PREPARE DATA FOR CLEANING AND ANALYSIS

# Select RFQ columns from 2019 data
rf_2019 <- rf_2019[,3:24]

# Rename location column
rf_2019 <- dplyr::rename(rf_2019, state = location)

# Remove second header line in 2020 data, then rename and grab numeric scores from columns
rf_2020 <- rf_2020 %>%
  dplyr::filter(RESP_GENDER != "Gender") %>%
  dplyr::rename(gender = RESP_GENDER,
                state = SCREENER1,
                rfq_1 = Q2086001786,
                rfq_2 = Q2073796874,
                rfq_3 = Q2026604185,
                rfq_4 = Q2038294139,
                rfq_5 = Q2097149062,
                rfq_6 = Q2005076527,
                rfq_7 = Q2099986100,
                rfq_8 = Q2014137399,
                rfq_9 = Q2047821109,
                rfq_10 = Q2071138905,
                rfq_11 = Q2082031934,
                ach_pos = Q2005648795,
                prev_neg = Q2064967607,
                rf_moremot = Q2096417839,
                obtainprotect_moremot = Q2061616163,
                foodest_open = Q2078453979,
                foodest_been = Q2015373138,
                foodest_plan = Q2067606070,
                salon_open = Q2029531417,
                salon_been = Q2077930763,
                salon_plan = Q2098211869,
                vitamins = Q2004035326,
                timewithpet = Q2063144300,
                computer_me = Q2071690348__1,
                computer_kids = Q2071690348__2,
                computer_secondhand = Q2071690348__3,
                computer_refurb = Q2071690348__4,
                computer_handdown = Q2071690348__5,
                computer_specupgrade = Q2071690348__6,
                computer_none = Q2071690348__7,
                creditcard = Q2097300961,
                rf_creditcard = Q2035360696,
                lifeins = Q2026863539,
                rf_lifeins = Q2093059946,
                contactless_first = Q2002812802,
                contactless_more = Q2051778461,
                bankapp_first = Q2077157945,
                bankapp_more = Q2060012316,
                rf_shopinperson = Q2001253794,
                target = Q2001547641,
                rf_target = Q2050454100,
                frozenfood = Q2097632970,
                rf_frozenfood = Q2079137883,
                ethnicity = Q2091531022,
                education = Q2057920686,
                income = Q2014095963,
                pol_orient = Q2066820448,
                agegroup = Q2090985821)
rf_2020$rfq_1 <- str_extract(rf_2020$rfq_1, "^.{1}")
rf_2020$rfq_2 <- str_extract(rf_2020$rfq_2, "^.{1}")
rf_2020$rfq_3 <- str_extract(rf_2020$rfq_3, "^.{1}")
rf_2020$rfq_4 <- str_extract(rf_2020$rfq_4, "^.{1}")
rf_2020$rfq_5 <- str_extract(rf_2020$rfq_5, "^.{1}")
rf_2020$rfq_6 <- str_extract(rf_2020$rfq_6, "^.{1}")
rf_2020$rfq_7 <- str_extract(rf_2020$rfq_7, "^.{1}")
rf_2020$rfq_8 <- str_extract(rf_2020$rfq_8, "^.{1}")
rf_2020$rfq_9 <- str_extract(rf_2020$rfq_9, "^.{1}")
rf_2020$rfq_10 <- str_extract(rf_2020$rfq_10, "^.{1}")
rf_2020$rfq_11 <- str_extract(rf_2020$rfq_11, "^.{1}")

rf_2020$state <- str_sub(rf_2020$state, start= -2)

# Convert RFQ columns to numeric in rf_2020
num <- c("rfq_1", "rfq_2", "rfq_3", "rfq_4", "rfq_5", "rfq_6", 
         "rfq_7", "rfq_8", "rfq_9", "rfq_10", "rfq_11") # Define numeric columns
rf_2020[num] <- lapply(rf_2020[num], as.character) # Convert numeric columns to character (before numeric) to prevent values from changing
rf_2020[num] <- lapply(rf_2020[num], as.numeric) # Convert numeric columns to numeric
rm(num) # Clear mfraw.num from workspace as it is no longer needed

# Calculate agegroup in 2019 data (consistent with 2020 age group levels)
rf_2019$agegroup <- case_when(rf_2019$age < 25 ~ "18 - 24",
                              rf_2019$age < 35 ~ "25 - 34",
                              rf_2019$age < 45 ~ "35 - 44",
                              rf_2019$age < 55 ~ "45 - 54",
                              rf_2019$age < 65 ~ "55 - 64",
                              rf_2019$age >= 65 ~ "65 or older")
rf_2019$age <- NULL

# Recode demographics in 2019 data to match 2020 coding
rf_2019$income <- case_when(rf_2019$income == "$10K-$20K" ~ "$10,000 - $20,000",
                            rf_2019$income == "$20K-$40K" ~ "$20,001 - $40,000",
                            rf_2019$income == "$40K-$70K" ~ "$40,001 - $70,000",
                            rf_2019$income == "$70K-$100K" ~ "$70,001 - $100,000",
                            rf_2019$income == "$100K-$250K" ~ "$100,001 - $250,000",
                            rf_2019$income == "$250K+" ~ "$250,001+")
rf_2019$education <- case_when(rf_2019$education == "Some High School" ~ "Other",
                            rf_2019$education == "High School" ~ "High School Diploma",
                            rf_2019$education == "Some College" ~ "High School Diploma",
                            rf_2019$education == "Associate's" ~ "Associates Degree",
                            rf_2019$education == "Bachelor's" ~ "Bachelors Degree",
                            rf_2019$education == "Master's" ~ "Graduate Degree",
                            rf_2019$education == "Doctorate" ~ "Graduate Degree",
                            rf_2019$education == "No Response" ~ "Other")
rf_2019$pol_orient <- case_when(rf_2019$pol_orient == "Very Conservative" ~ "Strongly Conservative",
                            rf_2019$pol_orient == "Very Liberal" ~ "Strongly Liberal",
                            rf_2019$pol_orient == "Conservative" ~ "Conservative",
                            rf_2019$pol_orient == "Liberal" ~ "Liberal",
                            rf_2019$pol_orient == "Slightly Conservative" ~ "Slightly Conservative",
                            rf_2019$pol_orient == "Slightly Liberal" ~ "Slightly Liberal",
                            rf_2019$pol_orient == "Moderate" ~ "Moderate")

# Add study year columns and then merge dataframes
rf_2019$year <- "2019"
rf_2020$year <- "2020"
rf <- bind_rows(rf_2019, rf_2020)
rm(rf_2019, rf_2020)

# Calculate prevention pride and promotion pride scores
rf$prev <- ((6-rf$rfq_2) + (6-rf$rfq_4) + rf$rfq_5 + 
              (6-rf$rfq_6) + (6-rf$rfq_8))/5
rf$prom <- ((6-rf$rfq_1) + rf$rfq_3 + rf$rfq_7 + (6-rf$rfq_9) + 
              rf$rfq_10 + (6-rf$rfq_11))/6

# Calculate promotion dominance scores
rf$promdom <- rf$prom - rf$prev

# Dummy-code year
rf$year.d <- NA
rf$year.d[rf$year == 2019] <- 0
rf$year.d[rf$year == 2020] <- 1

# Create an ordinal numeric version of the political orientation variable
rf$pol_orient.num <- recode(rf$pol_orient, `Strongly Conservative` = 1, 
                            `Conservative` = 2, `Slightly Conservative` = 3, 
                            `Moderate` = 4, `Slightly Liberal` = 5, 
                            `Liberal` = 6, `Strongly Liberal` = 7, .default = NA_real_)

# Create an ordinal numeric version of the age group variable
rf$agegroup.num <- recode(rf$agegroup, `18 - 24` = 1, `25 - 34` = 2, 
                          `35 - 44` = 3, `45 - 54` = 4, `55 - 64` = 5, 
                          `65 or older` = 6, .default = NA_real_)

# Dummy-code behavioral outcome variables
rf$foodest_open_certain.d <- case_when(rf$foodest_open == "Yes" ~ 1,
                               rf$foodest_open == "Uncertain" ~ 0,
                               rf$foodest_open == "No" ~ 1)
rf$foodest_been.d <- case_when(rf$foodest_been == "Yes" ~ 1,
                               rf$foodest_been == "Does not apply" ~ 0,
                               rf$foodest_been == "No" ~ 0)
rf$foodest_plan.d <- case_when(rf$foodest_plan == "Yes" ~ 1,
                               rf$foodest_plan == "No" ~ 0)
rf$salon_open_certain.d <- case_when(rf$salon_open == "Yes" ~ 1,
                             rf$salon_open == "Uncertain" ~ 0,
                             rf$salon_open == "No" ~ 1)
rf$salon_been.d <- case_when(rf$salon_been == "Yes" ~ 1,
                             rf$salon_been == "Does not apply" ~ 0,
                             rf$salon_been == "No" ~ 0)
rf$salon_plan.d <- case_when(rf$salon_plan == "Yes" ~ 1,
                             rf$salon_plan == "No" ~ 0)
rf$vitamins_current.d <- case_when(rf$vitamins == "Currently using" ~ 1,
                               rf$vitamins == "Considering using" ~ 0,
                               rf$vitamins == "Not considering using" ~ 0)
rf$frozenfood.d <- case_when(rf$frozenfood == "Yes" ~ 1,
                             rf$frozenfood == "No" ~ 0)

# Create subsets where needed for analyses
foodest <- filter(rf, foodest_open == "Yes" | foodest_open == "Uncertain") # n = 365
salon <- filter(rf, salon_open == "Yes" | salon_open == "Uncertain") # n = 412

# Subset 2019 and 2020
rf_2019 <- dplyr::filter(rf, year == 2019)
rf_2020 <- dplyr::filter(rf, year == 2020)
```

# Participants

## 2019 Data (Before COVID-19 Pandemic)

```{r rf_2019_ps}
# Gender
male <- sum(rf_2019$gender == "Male", na.rm = T) # n = 143
female <- sum(rf_2019$gender == "Female", na.rm = T) # n = 135
malepct <- round(male/nrow(rf_2019)*100, digits = 0) # 51%
femalepct <- round(female/nrow(rf_2019)*100, digits = 0) # 48%

# Age Group
eighteen24 <- round(nrow(filter(rf_2019, agegroup == "18 - 24"))/
                      nrow(rf_2019)*100, digits = 0) # 8%
twentyfive34 <- round(nrow(filter(rf_2019, agegroup == "25 - 34"))/
                        nrow(rf_2019)*100, digits = 0) # 42%
thirtyfive44 <- round(nrow(filter(rf_2019, agegroup == "35 - 44"))/
                        nrow(rf_2019)*100, digits = 0) # 29%
fortyfive54 <- round(nrow(filter(rf_2019, agegroup == "45 - 54"))/
                       nrow(rf_2019)*100, digits = 0) # 12%
fiftyfive64 <- round(nrow(filter(rf_2019, agegroup == "55 - 64"))/
                       nrow(rf_2019)*100, digits = 0) # 6%
sixtyfiveplus <- round(nrow(filter(rf_2019, agegroup == "65 or older"))/
                         nrow(rf_2019)*100, digits = 0) # 3%

# Political Orientation
stronglycons <- round(nrow(filter(rf_2019, pol_orient == "Strongly Conservative"))/
                        nrow(rf_2019)*100, digits = 0) # 4%
cons <- round(nrow(filter(rf_2019, pol_orient == "Conservative"))/
                nrow(rf_2019)*100, digits = 0) # 11%
slightlycons <- round(nrow(filter(rf_2019, pol_orient == "Slightly Conservative"))/
                        nrow(rf_2019)*100, digits = 0) # 11%
moderate <- round(nrow(filter(rf_2019, pol_orient == "Moderate"))/
                    nrow(rf_2019)*100, digits = 0) # 18%
slightlylib <- round(nrow(filter(rf_2019, pol_orient == "Slightly Liberal"))/
                       nrow(rf_2019)*100, digits = 0) # 15%
lib <- round(nrow(filter(rf_2019, pol_orient == "Liberal"))/
               nrow(rf_2019)*100, digits = 0) # 22%
stronglylib <- round(nrow(filter(rf_2019, pol_orient == "Strongly Liberal"))/
                       nrow(rf_2019)*100, digits = 0) # 18%
```

## 2020 Data (After COVID-19 Pandemic)

```{r rf_2020_ps}
# Gender
male <- sum(rf_2020$gender == "Male", na.rm = T) # n = 294
female <- sum(rf_2020$gender == "Female", na.rm = T) # n = 306
malepct <- round(male/nrow(rf_2020)*100, digits = 0) # 49%
femalepct <- round(female/nrow(rf_2020)*100, digits = 0) # 51%

# Age Group
eighteen24 <- round(nrow(filter(rf_2020, agegroup == "18 - 24"))/
                      nrow(rf_2020)*100, digits = 0) # 8%
twentyfive34 <- round(nrow(filter(rf_2020, agegroup == "25 - 34"))/
                        nrow(rf_2020)*100, digits = 0) # 27%
thirtyfive44 <- round(nrow(filter(rf_2020, agegroup == "35 - 44"))/
                        nrow(rf_2020)*100, digits = 0) # 8%
fortyfive54 <- round(nrow(filter(rf_2020, agegroup == "45 - 54"))/
                       nrow(rf_2020)*100, digits = 0) # 16%
fiftyfive64 <- round(nrow(filter(rf_2020, agegroup == "55 - 64"))/
                       nrow(rf_2020)*100, digits = 0) # 35%
sixtyfiveplus <- round(nrow(filter(rf_2020, agegroup == "65 or older"))/
                         nrow(rf_2020)*100, digits = 0) # 6%

# Political Orientation
stronglycons <- round(nrow(filter(rf_2020, pol_orient == "Strongly Conservative"))/
                        nrow(rf_2020)*100, digits = 0) # 11%
cons <- round(nrow(filter(rf_2020, pol_orient == "Conservative"))/
                nrow(rf_2020)*100, digits = 0) # 16%
slightlycons <- round(nrow(filter(rf_2020, pol_orient == "Slightly Conservative"))/
                        nrow(rf_2020)*100, digits = 0) # 10%
moderate <- round(nrow(filter(rf_2020, pol_orient == "Moderate"))/
                    nrow(rf_2020)*100, digits = 0) # 36%
slightlylib <- round(nrow(filter(rf_2020, pol_orient == "Slightly Liberal"))/
                       nrow(rf_2020)*100, digits = 0) # 8%
lib <- round(nrow(filter(rf_2020, pol_orient == "Liberal"))/
               nrow(rf_2020)*100, digits = 0) # 10%
stronglylib <- round(nrow(filter(rf_2020, pol_orient == "Strongly Liberal"))/
                       nrow(rf_2020)*100, digits = 0) # 9%
```

# Regulatory Focus Questionnaire: Summary Statistics

## 2019 Data (Before COVID-19 Pandemic)

```{r rf_2019_rf}
prommean <- myround(mean(rf_2019$prom, na.rm = T), digits = 2) # 3.59
promsd <- myround(sd(rf_2019$prom, na.rm = T), digits = 2) # 0.71
prom <- select(rf_2019, rfq_1, rfq_3, rfq_7, rfq_9, rfq_10, rfq_11)
promalpha <- myround(psych::alpha(prom, check.keys = TRUE)$total["raw_alpha"],
                     digits = 2)
# Accounts for rev-scored as expected; alpha = 0.74

prevmean <- myround(mean(rf_2019$prev, na.rm = T), digits = 2) # 3.43
prevsd <- myround(sd(rf_2019$prev, na.rm = T), digits = 2) # 0.84
prev <- select(rf_2019, rfq_2, rfq_4, rfq_5, rfq_6, rfq_8)
prevalpha <- myround(psych::alpha(prev, check.keys = TRUE)$total["raw_alpha"],
                     digits = 2)
# Accounts for rev-scored as expected; as expected; alpha = 0.84
```

## 2020 Data (After COVID-19 Pandemic)

```{r rf_2020_rf}
prommean <- myround(mean(rf_2020$prom, na.rm = T), digits = 2) # 3.46
promsd <- myround(sd(rf_2020$prom, na.rm = T), digits = 2) # 0.62
prom <- select(rf_2020, rfq_1, rfq_3, rfq_7, rfq_9, rfq_10, rfq_11)
promalpha <- myround(psych::alpha(prom, check.keys = TRUE)$total["raw_alpha"], 
                     digits = 2)
# Accounts for rev-scored as expected; alpha = 0.63

prevmean <- myround(mean(rf_2020$prev, na.rm = T), digits = 2) # 3.40
prevsd <- myround(sd(rf_2020$prev, na.rm = T), digits = 2) # 0.81
prev <- select(rf_2020, rfq_2, rfq_4, rfq_5, rfq_6, rfq_8)
prevalpha <- myround(psych::alpha(prev, check.keys = TRUE)$total["raw_alpha"], 
                     digits = 2)
# Accounts for rev-scored as expected; alpha = 0.80
```

# Results

## Differences in Regulatory Focus Before Versus After Start of COVID-19 Pandemic

```{r prom_diff}
prom.year <- lm(prom ~ year.d + agegroup.num + pol_orient.num, data = rf)
summary(prom.year)
prom.year.data <- summary(prom.year)$coefficients

prom.year.b <- prom.year.data["year.d", "Estimate"]
prom.year.se <- prom.year.data["year.d", "Std. Error"]
prom.year.t <- prom.year.data["year.d", "t value"]
prom.year.df <- summary(prom.year)$df[2]
prom.year.p <- prom.year.data["year.d", "Pr(>|t|)"]

confint(prom.year)
```

```{r prev_diff}
prev.year <- lm(prev ~ year.d + agegroup.num + pol_orient.num, data = rf)
summary(prev.year)
prev.year.data <- summary(prev.year)$coefficients

prev.year.b <- prev.year.data["year.d", "Estimate"]
prev.year.se <- prev.year.data["year.d", "Std. Error"]
prev.year.t <- prev.year.data["year.d", "t value"]
prev.year.df <- summary(prev.year)$df[2]
prev.year.p <- prev.year.data["year.d", "Pr(>|t|)"]

confint(prev.year)
```

```{r aim1_plots}
promsummary <- summarySE(rf, measurevar="prom", groupvars=c("year"))
promplot <- ggplot(data = rf, aes(x = year, y = prom)) +
  geom_point(alpha = .15, color = "seagreen3", 
             position = position_jitter(height = .05, width = .2)) +
  geom_point(data = promsummary, color = "black", size = 1.5) +
  geom_errorbar(data = promsummary, aes(ymin = prom - se, ymax = prom + se),
                width = .4, color = "black", size = .4) +
  geom_signif(y_position = c(4.2), xmin = c(1), xmax = c(2), annotation = c("***"),
              textsize = 6, color = "black", vjust = -.4) +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", x = .6, y = 1.5, label = "a", size = 9) +
  labs(x = "Year", y = "Promotion Pride")

prevsummary <- summarySE(rf, measurevar="prev", groupvars=c("year"))
prevplot <- ggplot(data = rf, aes(x = year, y = prev)) +
  geom_point(alpha = .15, color = "lightcoral",
             position = position_jitter(height = .05, width = .2)) +
  geom_point(data = prevsummary, color = "black", size = 1.5) +
  geom_errorbar(data = prevsummary, aes(ymin = prev - se, ymax = prev + se),
                width = .4, color = "black", size = .4) +
  geom_signif(y_position = c(4.2), xmin = c(1), xmax = c(2), annotation = c("*"),
              textsize = 6, color = "black", vjust = -.4) +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", x = .6, y = 1.5, label = "b", size = 9) +
  labs(x = "Year", y = "Prevention Pride")
```

Figure 1: Differences in promotion pride and prevention pride before (2019) versus after (2020) the start of the COVID-19 pandemic, controlling for participants' age group and political ideology. Error bars represent standard errors of the mean.

```{r fig1, include = TRUE, fig.align = "center"}
grid.arrange(promplot, prevplot, ncol=2, heights = c(3, 3), widths = c(4, 4))
```

## Associations Between Post-COVID-19 Regulatory Focus Pride and Behavioral Outcomes

### Sensitivity to the Opening of the Market

```{r foodest_open}
foodest_open.rf <- glm(foodest_open_certain.d ~ prom + prev + agegroup.num + pol_orient.num,
                       data = rf, family = "binomial")
summary(foodest_open.rf)
foodest_open.rf.data <- summary(foodest_open.rf)$coefficients

foodest_open.rf.prom.b <- foodest_open.rf.data["prom", "Estimate"]
foodest_open.rf.prom.se <- foodest_open.rf.data["prom", "Std. Error"]
foodest_open.rf.prom.z <- foodest_open.rf.data["prom", "z value"]
foodest_open.rf.prom.df <- summary(foodest_open.rf)$df[2]
foodest_open.rf.prom.p <- foodest_open.rf.data["prom", "Pr(>|z|)"]
foodest_open.rf.prom.or <- exp(foodest_open.rf.prom.b)

foodest_open.rf.prev.b <- foodest_open.rf.data["prev", "Estimate"]
foodest_open.rf.prev.se <- foodest_open.rf.data["prev", "Std. Error"]
foodest_open.rf.prev.z <- foodest_open.rf.data["prev", "z value"]
foodest_open.rf.prev.df <- summary(foodest_open.rf)$df[2]
foodest_open.rf.prev.p <- foodest_open.rf.data["prev", "Pr(>|z|)"]
foodest_open.rf.prev.or <- exp(foodest_open.rf.prev.b)

confint(foodest_open.rf)
```

```{r salon_open}
salon_open.rf <- glm(salon_open_certain.d ~ prom + prev + agegroup.num + pol_orient.num,
                     data = rf, family = "binomial")
summary(salon_open.rf)
salon_open.rf.data <- summary(salon_open.rf)$coefficients

salon_open.rf.prom.b <- salon_open.rf.data["prom", "Estimate"]
salon_open.rf.prom.se <- salon_open.rf.data["prom", "Std. Error"]
salon_open.rf.prom.z <- salon_open.rf.data["prom", "z value"]
salon_open.rf.prom.df <- summary(salon_open.rf)$df[2]
salon_open.rf.prom.p <- salon_open.rf.data["prom", "Pr(>|z|)"]
salon_open.rf.prom.or <- exp(salon_open.rf.prom.b)

salon_open.rf.prev.b <- salon_open.rf.data["prev", "Estimate"]
salon_open.rf.prev.se <- salon_open.rf.data["prev", "Std. Error"]
salon_open.rf.prev.z <- salon_open.rf.data["prev", "z value"]
salon_open.rf.prev.df <- summary(salon_open.rf)$df[2]
salon_open.rf.prev.p <- salon_open.rf.data["prev", "Pr(>|z|)"]
salon_open.rf.prev.or <- exp(salon_open.rf.prev.b)

confint(salon_open.rf)
```

### Plans to Move Forward with Marketplace Activity

```{r foodest_plan}
foodest_plan.rf <- glm(foodest_plan.d ~ prom + prev + agegroup.num + pol_orient.num,
                       data = foodest, family = "binomial")
summary(foodest_plan.rf)
foodest_plan.rf.data <- summary(foodest_plan.rf)$coefficients

foodest_plan.rf.prom.b <- foodest_plan.rf.data["prom", "Estimate"]
foodest_plan.rf.prom.se <- foodest_plan.rf.data["prom", "Std. Error"]
foodest_plan.rf.prom.z <- foodest_plan.rf.data["prom", "z value"]
foodest_plan.rf.prom.df <- summary(foodest_plan.rf)$df[2]
foodest_plan.rf.prom.p <- foodest_plan.rf.data["prom", "Pr(>|z|)"]
foodest_plan.rf.prom.or <- exp(foodest_plan.rf.prom.b)

foodest_plan.rf.prev.b <- foodest_plan.rf.data["prev", "Estimate"]
foodest_plan.rf.prev.se <- foodest_plan.rf.data["prev", "Std. Error"]
foodest_plan.rf.prev.z <- foodest_plan.rf.data["prev", "z value"]
foodest_plan.rf.prev.df <- summary(foodest_plan.rf)$df[2]
foodest_plan.rf.prev.p <- foodest_plan.rf.data["prev", "Pr(>|z|)"]
foodest_plan.rf.prev.or <- exp(foodest_plan.rf.prev.b)

confint(foodest_plan.rf)
```

```{r salon_plan}
salon_plan.rf <- glm(salon_plan.d ~ prom + prev + agegroup.num + pol_orient.num,
                     data = salon, family = "binomial")
summary(salon_plan.rf)
salon_plan.rf.data <- summary(salon_plan.rf)$coefficients

salon_plan.rf.prom.b <- salon_plan.rf.data["prom", "Estimate"]
salon_plan.rf.prom.se <- salon_plan.rf.data["prom", "Std. Error"]
salon_plan.rf.prom.z <- salon_plan.rf.data["prom", "z value"]
salon_plan.rf.prom.df <- summary(salon_plan.rf)$df[2]
salon_plan.rf.prom.p <- salon_plan.rf.data["prom", "Pr(>|z|)"]
salon_plan.rf.prom.or <- exp(salon_plan.rf.prom.b)

salon_plan.rf.prev.b <- salon_plan.rf.data["prev", "Estimate"]
salon_plan.rf.prev.se <- salon_plan.rf.data["prev", "Std. Error"]
salon_plan.rf.prev.z <- salon_plan.rf.data["prev", "z value"]
salon_plan.rf.prev.df <- summary(salon_plan.rf)$df[2]
salon_plan.rf.prev.p <- salon_plan.rf.data["prev", "Pr(>|z|)"]
salon_plan.rf.prev.or <- exp(salon_plan.rf.prev.b)

confint(salon_plan.rf)
```

### Behavior Involving Moving Forward with Marketplace Activity

```{r foodest_been}
foodest_been.rf <- glm(foodest_been.d ~ prom + prev + agegroup.num + pol_orient.num,
                       data = foodest, family = "binomial")
summary(foodest_been.rf)
foodest_been.rf.data <- summary(foodest_been.rf)$coefficients

foodest_been.rf.prom.b <- foodest_been.rf.data["prom", "Estimate"]
foodest_been.rf.prom.se <- foodest_been.rf.data["prom", "Std. Error"]
foodest_been.rf.prom.z <- foodest_been.rf.data["prom", "z value"]
foodest_been.rf.prom.df <- summary(foodest_been.rf)$df[2]
foodest_been.rf.prom.p <- foodest_been.rf.data["prom", "Pr(>|z|)"]
foodest_been.rf.prom.or <- exp(foodest_been.rf.prom.b)

foodest_been.rf.prev.b <- foodest_been.rf.data["prev", "Estimate"]
foodest_been.rf.prev.se <- foodest_been.rf.data["prev", "Std. Error"]
foodest_been.rf.prev.z <- foodest_been.rf.data["prev", "z value"]
foodest_been.rf.prev.df <- summary(foodest_been.rf)$df[2]
foodest_been.rf.prev.p <- foodest_been.rf.data["prev", "Pr(>|z|)"]
foodest_been.rf.prev.or <- exp(foodest_been.rf.prev.b)

confint(foodest_been.rf)
```

```{r salon_been}
salon_been.rf <- glm(salon_been.d ~ prom + prev + agegroup.num + pol_orient.num,
                     data = salon, family = "binomial")
summary(salon_been.rf)
salon_been.rf.data <- summary(salon_been.rf)$coefficients

salon_been.rf.prom.b <- salon_been.rf.data["prom", "Estimate"]
salon_been.rf.prom.se <- salon_been.rf.data["prom", "Std. Error"]
salon_been.rf.prom.z <- salon_been.rf.data["prom", "z value"]
salon_been.rf.prom.df <- summary(salon_been.rf)$df[2]
salon_been.rf.prom.p <- salon_been.rf.data["prom", "Pr(>|z|)"]
salon_been.rf.prom.or <- exp(salon_been.rf.prom.b)

salon_been.rf.prev.b <- salon_been.rf.data["prev", "Estimate"]
salon_been.rf.prev.se <- salon_been.rf.data["prev", "Std. Error"]
salon_been.rf.prev.z <- salon_been.rf.data["prev", "z value"]
salon_been.rf.prev.df <- summary(salon_been.rf)$df[2]
salon_been.rf.prev.p <- salon_been.rf.data["prev", "Pr(>|z|)"]
salon_been.rf.prev.or <- exp(salon_been.rf.prev.b)

confint(salon_been.rf)
```

### Usage of Vitamin Supplements for Health and Well-Being

```{r vitamins_current}
vitamins_current.rf <- glm(vitamins_current.d ~ prom + prev + agegroup.num + pol_orient.num,
                           data = rf, family = "binomial")
summary(vitamins_current.rf)
vitamins_current.rf.data <- summary(vitamins_current.rf)$coefficients

vitamins_current.rf.prom.b <- vitamins_current.rf.data["prom", "Estimate"]
vitamins_current.rf.prom.se <- vitamins_current.rf.data["prom", "Std. Error"]
vitamins_current.rf.prom.z <- vitamins_current.rf.data["prom", "z value"]
vitamins_current.rf.prom.df <- summary(vitamins_current.rf)$df[2]
vitamins_current.rf.prom.p <- vitamins_current.rf.data["prom", "Pr(>|z|)"]
vitamins_current.rf.prom.or <- exp(vitamins_current.rf.prom.b)

vitamins_current.rf.prev.b <- vitamins_current.rf.data["prev", "Estimate"]
vitamins_current.rf.prev.se <- vitamins_current.rf.data["prev", "Std. Error"]
vitamins_current.rf.prev.z <- vitamins_current.rf.data["prev", "z value"]
vitamins_current.rf.prev.df <- summary(vitamins_current.rf)$df[2]
vitamins_current.rf.prev.p <- vitamins_current.rf.data["prev", "Pr(>|z|)"]
vitamins_current.rf.prev.or <- exp(vitamins_current.rf.prev.b)

confint(vitamins_current.rf)
```

### Purchases Frozen Food

```{r frozenfood}
frozenfood.rf <- glm(frozenfood.d ~ prom + prev + agegroup.num + pol_orient.num,
                     data = rf, family = "binomial")
summary(frozenfood.rf)
confint(frozenfood.rf)
```
